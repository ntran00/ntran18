

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milestone 3</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }
        /* Navbar styling */
        .navbar {
            background-color: #2588BE;
            padding: 10px 20px;
            color: white;
            text-align: center;
        }
        .navbar a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            font-weight: bold;
        }
        .navbar a:hover {
            text-decoration: underline;
        }
        /* Main content styling */
        h1 {
            text-align: center;
            margin-top: 20px;
        }
   
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<!-- Navbar -->
<div class="navbar">
    <a href="index.html">Home</a>
    <a href="milestone1.html">Milestone 1</a>
    <a href="booksearchpage.html">Milestone 2</a>
    <a href="milestone3.html">Milestone 3</a>
    <a href="milestone4.html">Milestone 4</a>
</div>

<div id="content">
    <input type="text" id="searchTerm" placeholder="Enter search term">
    <button id="searchBtn">Search</button>
    <div id="book-results"></div>

    <!-- Pagination -->
    <div class="pagination" id="pagination"></div>

    <!-- Book Details Section -->
    <div id="book-details"></div>

    <!-- Bookshelf Results -->
    <h2>My Bookshelf</h2>
    <div id="bookshelf-results"></div>
</div>

<script>
$(document).ready(function() {
    let currentPage = 1;
    const resultsPerPage = 10;
    let totalResults = 0;
    const maxPagesToShow = 5;

    // Search function
    $('#searchBtn').click(function() {
        const searchTerm = $('#searchTerm').val();
        if (searchTerm.trim() === '') {
            alert("Please enter a search term.");
            return;
        }

        // Call the Google Books API with AJAX
        const apiURL = `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(searchTerm)}&startIndex=${(currentPage - 1) * resultsPerPage}&maxResults=${resultsPerPage}`;
        
        $.ajax({
            url: apiURL,
            method: 'GET',
            success: function(data) {
                totalResults = data.totalItems;
                displayResults(data.items, '#book-results');
                displayPagination(totalResults, currentPage);
            },
            error: function() {
                alert("Failed to fetch data. Please check your connection or try again later.");
            }
        });
    });

    // Pagination function
    function displayPagination(totalResults, currentPage) {
        const totalPages = Math.ceil(totalResults / resultsPerPage);
        let paginationHTML = '';

        // Determine start and end page numbers for the current set of 5 pages
        const startPage = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));
        const endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);

        // Display previous set of pages if we're beyond page 1
        if (startPage > 1) {
            paginationHTML += `<button data-page="1">1</button>...`;
        }

        // Generate page buttons for current set of pages
        for (let i = startPage; i <= endPage; i++) {
            paginationHTML += `<button class="${i === currentPage ? 'active' : ''}" data-page="${i}">${i}</button>`;
        }

        // Display next set of pages if there are more pages beyond the current set
        if (endPage < totalPages) {
            paginationHTML += `...<button data-page="${endPage + 1}">></button>`;
        }

        $('#pagination').html(paginationHTML);
    }

    // Event listener for pagination buttons
    $('#pagination').on('click', 'button', function() {
        currentPage = $(this).data('page');
        $('#searchBtn').click();  // Perform the search again when a new page is selected
    });

    // Display search results
    function displayResults(books, container) {
        let output = '';
        books.forEach(book => {
            const title = book.volumeInfo.title;
            const coverImg = book.volumeInfo.imageLinks ? book.volumeInfo.imageLinks.thumbnail : 'no-image.png';
            const bookId = book.id;

            output += `
                <div class="book-item">
                    <img src="${coverImg}" alt="${title}">
                    <a href="#" class="book-link" data-book-id="${bookId}">${title}</a>
                </div>
            `;
        });
        $(container).html(output);
    }

    // Fetch book details and display them
    $(document).on('click', '.book-link', function(e) {
        e.preventDefault();
        const bookId = $(this).data('book-id');
        const apiURL = `https://www.googleapis.com/books/v1/volumes/${bookId}`;
        
        $.ajax({
            url: apiURL,
            method: 'GET',
            success: function(book) {
                const bookDetails = `
                    <h3>${book.volumeInfo.title}</h3>
                    <img src="${book.volumeInfo.imageLinks ? book.volumeInfo.imageLinks.thumbnail : 'no-image.png'}" alt="${book.volumeInfo.title}">
                    <p><strong>Author:</strong> ${book.volumeInfo.authors.join(', ')}</p>
                    <p><strong>Publisher:</strong> ${book.volumeInfo.publisher}</p>
                    <p><strong>Description:</strong> ${book.volumeInfo.description}</p>
                `;
                $('#book-details').html(bookDetails);
            },
            error: function() {
                alert("Failed to load book details.");
            }
        });
    });

    // Display books from your public bookshelf
    const bookshelfApiURL = 'https://www.googleapis.com/books/v1/users/110747721796776298740/bookshelves/0/volumes';
    $.ajax({
        url: bookshelfApiURL,
        method: 'GET',
        success: function(data) {
            displayResults(data.items, '#bookshelf-results');
        },
        error: function() {
            alert("Failed to load bookshelf.");
        }
    });
});
</script>




</body>
</html>
